<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Мои Проекты</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      /* Простой эффект свечения для карточек */
      .project-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1), 0 6px 6px rgba(0, 0, 0, 0.1);
      }
      .project-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
    </style>
  </head>
  <body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200">
    <div class="container mx-auto px-4 py-12">
      <!-- Заголовок страницы -->
      <header class="text-center mb-12">
        <h2 class="text-4xl md:text-5xl font-bold mb-2">
          Коллекция моих работ и экспериментов
        </h2>
      </header>

      <!-- Сетка для проектов -->
      <main
        id="projects-grid"
        class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8"
      >
        <!-- Карточки проектов будут добавлены сюда с помощью JavaScript -->
      </main>

      <!-- Индикатор загрузки -->
      <div id="loader" class="text-center py-8">
        <p class="text-gray-500">Загрузка проектов...</p>
      </div>

      <!-- Сообщение об ошибке -->
      <div
        id="error-message"
        class="hidden text-center py-8 bg-red-100 dark:bg-red-900 border border-red-400 text-red-700 dark:text-red-300 px-4 py-3 rounded-lg"
      >
        <p>
          Не удалось загрузить список проектов. Убедитесь, что репозиторий
          публичный и API GitHub доступен.
        </p>
      </div>

      <!-- Подвал -->
      <footer class="text-center mt-16 text-gray-500 dark:text-gray-400">
        <p>&copy; <span id="current-year"></span> nikitoid</p>
      </footer>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // Установка текущего года в подвале
        document.getElementById("current-year").textContent =
          new Date().getFullYear();

        // --- НАСТРОЙКА ---
        const GITHUB_USERNAME = "nikitoid";
        const GITHUB_REPO = "nikitoid.github.io";
        // -----------------

        const grid = document.getElementById("projects-grid");
        const loader = document.getElementById("loader");
        const errorMessage = document.getElementById("error-message");

        // Проверяем, были ли заменены значения по умолчанию
        if (
          GITHUB_USERNAME === "YOUR_USERNAME" ||
          GITHUB_REPO === "YOUR_REPO_NAME"
        ) {
          loader.style.display = "none";
          const setupMessage = document.createElement("div");
          setupMessage.className =
            "col-span-full text-center p-8 bg-yellow-100 dark:bg-yellow-900 border border-yellow-400 text-yellow-800 dark:text-yellow-300 rounded-lg";
          setupMessage.innerHTML = `
                    <h3 class="font-bold text-lg mb-2">Требуется настройка!</h3>
                    <p>Пожалуйста, откройте файл <strong>index.html</strong> и замените <code>YOUR_USERNAME</code> и <code>YOUR_REPO_NAME</code> на ваши данные от GitHub в секции &lt;script&gt;.</p>
                `;
          grid.appendChild(setupMessage);
          return;
        }

        // URL для API GitHub, чтобы получить содержимое репозитория
        const apiUrl = `https://api.github.com/repos/${GITHUB_USERNAME}/${GITHUB_REPO}/contents/`;

        async function fetchProjects() {
          try {
            const response = await fetch(apiUrl);
            if (!response.ok) {
              throw new Error(`Ошибка сети: ${response.statusText}`);
            }
            const data = await response.json();

            // Фильтруем, чтобы получить только папки (проекты)
            const projects = data.filter(
              (item) =>
                item.type === "dir" &&
                !item.name.startsWith(".") &&
                item.name !== "node_modules" &&
                item.name !== "vendor"
            );

            loader.style.display = "none";

            if (projects.length === 0) {
              const noProjectsMessage = document.createElement("p");
              noProjectsMessage.textContent =
                "Проекты еще не добавлены. Создайте папку в репозитории, и она появится здесь.";
              noProjectsMessage.className =
                "col-span-full text-center text-gray-500";
              grid.appendChild(noProjectsMessage);
              return;
            }

            // Для каждой папки создаем карточку
            projects.forEach((project) => {
              const card = createProjectCard(project);
              grid.appendChild(card);
            });
          } catch (error) {
            console.error("Не удалось получить проекты:", error);
            loader.style.display = "none";
            errorMessage.style.display = "block";
          }
        }

        function createProjectCard(project) {
          const projectUrl = `${project.name}/`; // Ссылка на подпапку
          const card = document.createElement("a");
          card.href = projectUrl;
          card.className =
            "project-card bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden block";

          // Форматируем имя папки для заголовка
          const title = project.name
            .replace(/-/g, " ")
            .replace(/\b\w/g, (l) => l.toUpperCase());

          // Пытаемся найти скриншот внутри папки проекта
          const screenshotUrl = `${project.name}/screenshot.png`;

          card.innerHTML = `
                    <div class="w-full h-48 bg-gray-200 dark:bg-gray-700 flex items-center justify-center">
                        <img src="${screenshotUrl}" 
                             alt="Скриншот проекта ${title}" 
                             class="w-full h-full object-cover"
                             onerror="this.onerror=null; this.parentElement.innerHTML = '<span class=\\'text-gray-500\\'>Нет скриншота</span>';">
                    </div>
                    <div class="p-6">
                        <h2 class="text-xl font-bold mb-2">${title}</h2>
                        <p class="text-gray-600 dark:text-gray-400 mb-4">Нажмите, чтобы открыть проект.</p>
                        <span class="text-blue-500 dark:text-blue-400 font-semibold hover:underline">Перейти →</span>
                    </div>
                `;
          return card;
        }

        fetchProjects();
      });
    </script>
  </body>
</html>
